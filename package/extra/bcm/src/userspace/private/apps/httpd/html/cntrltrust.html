<html>
  <head>
    <meta charset='utf-8'>
    <title>Controller Trust Configuration</title>
    <link rel='stylesheet' href='tabletab.css' type='text/css'>
    <script src='jquery.js'></script>
    <script>
      var sessionKey='<%ejGetOther(sessionKey)%>';

      function cfgClick() {
        var val = '';
        var loc = 'cntrltrustcfg.cgi?';

        // validate Inactivity Timer
        if (isNaN(document.getElementById('timer').value)) {
          alert('Inactivity timer is not a number.');
          return;
        }

        // Untrusted Role
        val += document.getElementById('untrustedRole').value + '|';
        // Banned Role
        val += document.getElementById('bannedRole').value + '|';
        // TOFUAllowed
        if (document.getElementById('allow-1').checked)
          val += '1,';
        else
          val += '0,';
        // Inactivity Timer
        val += document.getElementById('timer').value;

        loc += 'uspAction=apply&uspInfo=' + val;

        loc += '&sessionKey=' + sessionKey;

        location.href = loc;
      }

      function bodyLoad() {
        var cntrlTrust = '<%ejGetOther(uspGetCntrlTrust)%>';
        var info = cntrlTrust.split('|');

        // Untrusted Role
        document.getElementById('untrustedRole').value = info[0];
        // Banned Role
        document.getElementById('bannedRole').value = info[1];
        // TOFUAllowed
        if (info[2] == '1')
           document.getElementById('allow-1').checked = true;
        else
           document.getElementById('allow-0').checked = true;
        // Inactivity Timer
        document.getElementById('timer').value = info[3];
      }
    </script>
  </head>
  <body onload='bodyLoad()'>
  <form>
    <center><h3>Controller Trust Configuration</h3><br>
    <div id='cntrl-trust'><center>
      <table id='tblCntrlTrust' border='1' cellpadding='4' cellspacing='0'>
        <tbody>
          <tr>
            <td class='hd'>Untrusted Role</td>
            <td colspan='2'><input type='text' id='untrustedRole'></td>
          </tr>
          <tr>
            <td class='hd'>Banned Role</td>
            <td colspan='2'><input type='text' id='bannedRole'></td>
          </tr>
          <tr>
            <td class='hd'>Allowed Trust On First Use</td>
            <td><input name='allow' id='allow-0' type='radio'>  No</td>
            <td><input name='allow' id='allow-1' type='radio'>  Yes</td>
          </tr>
          <tr>
            <td class='hd'>Inactivity Timer (seconds)</td>
            <td colspan='2'><input type='text' id='timer'></td>
          </tr>
        </tbody>
      </table>
    </div>
    <br><br>
    <input type='button' id='btnCfg' value='Apply' onclick='cfgClick()'>
    <br><br>
  </form>
  </body>
</html>
