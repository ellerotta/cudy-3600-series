<html>
   <head>
      <meta HTTP-EQUIV='Pragma' CONTENT='no-cache'>
      <link rel="stylesheet" href='stylemain.css' type='text/css'>
         <link rel="stylesheet" href='colors.css' type='text/css'>
            <script language="javascript" src="util.js"></script>
            <script language="javascript">
<!-- hide
var openVSInfo = '<%ejGetOther(openVS)%>';if (openVSInfo == '&nbsp') openVSInfo = '';
var openVSCfg = openVSInfo.split('|');
var ofControllerAddr=openVSCfg[1];if (ofControllerAddr == '&nbsp') ofControllerAddr = '';
var ofControllerPort=openVSCfg[2];if (ofControllerPort == '&nbsp') ofControllerPort = '';
var OVSBridges = '<%ejGetOther(openVSBridges)%>';
var sessionKey = '<%ejGetOther(sessionKey)%>';

function chkopenvsClick(cb) {
   if ( cb.checked == true )
      hideNameInfo(0);
   else
      hideNameInfo(1);
}

function hideNameInfo(hide) {
   var status = 'visible';

   if ( hide == 1 )
      status = 'hidden';
   if (document.getElementById)  // DOM3 = IE5, NS6
      document.getElementById('hideinfo').style.visibility = status;
   else {
      if (document.layers == false) // IE4
         document.all.hideinfo.style.visibility = status;
   }
}


function reloading() {
   var loc = 'openvs_cfg.html';
   var code = 'location="' + loc + '"';
   window.defaultStatus = '';
   eval(code);
}

function addBridgeClick() {
   var loc = 'openvs_addbr.html';
   var code = 'location="' + loc + '"';
   eval(code);
}

function removeBridgeClick(rml) {
   var rmLst = '';
   var sep = '';

   if (rml.length > 0) {
       for (i = 0; i < rml.length; i++) {
           if (rml[i].checked == true) {
               rmLst += sep;
               rmLst += rml[i].value;
               sep = ',';
           }
       }
   } else if (rml.checked == true) {
       rmLst += rml.value;
   }

   var loc = 'ovsBridge.cmd?action=delbr&rmLst=' + rmLst;
   loc += '&sessionKey=' + sessionKey;
   var code = 'location="' + loc + '"';
   eval(code);
}

function editBridgeClick(brName) {
   var loc = 'ovsBridge.cmd?action=editbr&brName=' + brName;
   loc += '&sessionKey=' + sessionKey;
   var code = 'location="' + loc + '"';
   eval(code);
}

function btnApplySave() {
   var loc = 'openVS.cmd?';

   with ( document.forms[0] ) {
      var tempList = '';
      if (chkopenvs.checked == true) {
         loc += 'enblOpenVS=1';
      }

      if (controllerAddr.value =='') {
         msg = 'Please input OF controller address.';
         alert(msg);
         return;
      }

      if (isValidIpAddress(controllerAddr.value) == false) {
         msg = 'OF controller address "' + controllerAddr.value + '" is invalid.';
         alert(msg);
         return;
      }

      if (controllerPort.value == ''){
         msg = 'Please input OF controller port.';
         alert(msg);
         return;
      }

      if (isValidPort(controllerPort.value) == false ) {
         msg = 'OF controller port "' + controllerPort.value + '" is invalid port number';
         alert(msg);
         return;
      }

      loc += '&ofControllerAddr=' + controllerAddr.value;
      loc += '&ofControllerPort=' + controllerPort.value;
   }

   loc += '&sessionKey=' + sessionKey;
   var code = 'location="' + loc + '"';
   eval(code);
}

function frmLoad() {
   with ( document.forms[0] ) {
      if (openVSCfg[0] == 1)
      {
         chkopenvs.checked = true;
         hideNameInfo(0);
      }
      else
      {
         chkopenvs.checked = false;
         hideNameInfo(1);
      }

      controllerAddr.value = ofControllerAddr;
      controllerPort.value = ofControllerPort;
   }
}

// done hiding -->
</script>
   </head>
   <body onLoad='frmLoad()'>
      <blockquote>
         <form>
            <P>
               <b>OpenVswitch Configuration</b><br><br>
            </P>
            <tr>
               <td colspan="2">
                  <input type='checkbox' name='chkopenvs' onClick='chkopenvsClick(this)'></td>
               <td>
                    <b>Enable OpenVswitch</b></td>
            </tr>
            <br>
            <div id='hideinfo'>
              <br>
              <tr>
                  <td width='140'><b>OF controller IP address:</b></td>
                  <td><input type='text' name='controllerAddr'></td>
                  <td width='6'><b> port:</b></td>
                  <td><input type='text' name='controllerPort'></td>
             </tr>
             <br>
             <br><b> OVS Bridge List</b><br>
             <table border='1' cellpadding='4' cellspacing='0'>
                 <tr>
                     <td class='hd'>Bridge Name</td>
                     <td class='hd'>Remove</td>
                     <td class='hd'>Edit</td>
                 </tr>
                 <script language="javascript">
                 <!-- hide
                 {
                     var i = 0;
                     var openVSBridgeList;
                     openVSBridgeList = OVSBridges.split(',');
                     for (i = 0; i < openVSBridgeList.length; i++) {
                        if ( openVSBridgeList[i] != "" ) {
                            document.writeln("<tr>");
                            document.write("<td>" + openVSBridgeList[i] + "</td>\n");
                            document.write("<td><input type='checkbox' name='selBr' value='" + openVSBridgeList[i] + "'></td>\n");
                            document.write("<td><input type='button' onClick='editBridgeClick(\"" + openVSBridgeList[i] + "\")' value='&nbsp;Edit&nbsp;'></td>\n");
                            document.writeln("</tr>");
                        }
                     }
                 }
                 // done hiding -->
                 </script>
             </table>
             <input type='button' onClick='addBridgeClick()' value='Add'>
             <input type='button' onClick='removeBridgeClick(this.form.selBr)' value='Remove'>
             <br>
            <br>
            </div>
            <center>
               <input type='button' onClick='btnApplySave()' value='Apply/Save'>
            </center>
         </form>
      </blockquote>
   </body>
</html>
