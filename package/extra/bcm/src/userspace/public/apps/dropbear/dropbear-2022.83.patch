diff -Naur orig_dropbear-2022.83/buffer.c dropbear-2022.83/buffer.c
--- orig_dropbear-2022.83/buffer.c	2022-11-14 22:30:00.000000000 +0800
+++ dropbear-2022.83/buffer.c	2022-11-16 16:27:25.649860939 +0800
@@ -261,7 +261,7 @@
 
 /* Get an uint32 from the buffer and increment the pos */
 unsigned int buf_getint(buffer* buf) {
-	unsigned int ret;
+	unsigned int ret=0;
 
 	LOAD32H(ret, buf_getptr(buf, 4));
 	buf_incrpos(buf, 4);
diff -Naur orig_dropbear-2022.83/configure dropbear-2022.83/configure
--- orig_dropbear-2022.83/configure	2022-11-14 22:30:00.000000000 +0800
+++ dropbear-2022.83/configure	2022-11-17 10:02:16.310511648 +0800
@@ -3989,11 +3989,11 @@
 
 
 # set compile flags prior to other tests
-if test -z "$ORIGCFLAGS" && test "$GCC" = "yes"; then
-	{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: No \$CFLAGS set... using \"-Os -W -Wall\" for GCC" >&5
-printf "%s\n" "$as_me: No \$CFLAGS set... using \"-Os -W -Wall\" for GCC" >&6;}
-	CFLAGS="-Os -W -Wall"
-fi
+#if test -z "$ORIGCFLAGS" && test "$GCC" = "yes"; then
+#	{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: No \$CFLAGS set... using \"-Os -W -Wall\" for GCC" >&5
+#printf "%s\n" "$as_me: No \$CFLAGS set... using \"-Os -W -Wall\" for GCC" >&6;}
+#	CFLAGS="-Os -W -Wall"
+#fi
 
 # LTM_CFLAGS is given to ./configure by the user,
 # DROPBEAR_LTM_CFLAGS is substituted in the LTM Makefile.in
diff -Naur orig_dropbear-2022.83/default_options.h dropbear-2022.83/default_options.h
--- orig_dropbear-2022.83/default_options.h	2022-11-14 22:30:00.000000000 +0800
+++ dropbear-2022.83/default_options.h	2022-11-16 16:27:25.649860939 +0800
@@ -21,10 +21,10 @@
 /* Default hostkey paths - these can be specified on the command line.
  * Homedir is prepended if path begins with ~/
  */
-#define DSS_PRIV_FILENAME "/etc/dropbear/dropbear_dss_host_key"
-#define RSA_PRIV_FILENAME "/etc/dropbear/dropbear_rsa_host_key"
-#define ECDSA_PRIV_FILENAME "/etc/dropbear/dropbear_ecdsa_host_key"
-#define ED25519_PRIV_FILENAME "/etc/dropbear/dropbear_ed25519_host_key"
+#define DSS_PRIV_FILENAME "/var/tmp/dropbear_dss_host_key"
+#define RSA_PRIV_FILENAME "/var/tmp/dropbear_rsa_host_key"
+#define ECDSA_PRIV_FILENAME "/var/tmp/dropbear_ecdsa_host_key"
+#define ED25519_PRIV_FILENAME "/var/tmp/dropbear_ed25519_host_key"
 
 /* Set NON_INETD_MODE if you require daemon functionality (ie Dropbear listens
  * on chosen ports and keeps accepting connections. This is the default.
@@ -147,18 +147,18 @@
  * code (either ECDSA or ECDH) increases binary size - around 30kB
  * on x86-64.
  * See: ECDSA_PRIV_FILENAME  */
-#define DROPBEAR_ECDSA 1
+#define DROPBEAR_ECDSA 0
 
 /* Ed25519 is faster than ECDSA. Compiling in Ed25519 code increases
  * binary size - around 7,5kB on x86-64.
  * See: ED25519_PRIV_FILENAME  */
-#define DROPBEAR_ED25519 1
+#define DROPBEAR_ED25519 0
 
 /* Allow U2F security keys for public key auth, with
  * sk-ecdsa-sha2-nistp256@openssh.com or sk-ssh-ed25519@openssh.com keys.
  * The corresponding DROPBEAR_ECDSA or DROPBEAR_ED25519 also needs to be set.
  * This is currently server-only. */
-#define DROPBEAR_SK_KEYS 1
+#define DROPBEAR_SK_KEYS 0
 
 /* RSA must be >=1024 */
 #define DROPBEAR_DEFAULT_RSA_SIZE 2048
@@ -215,10 +215,10 @@
 #define DROPBEAR_ZLIB_WINDOW_BITS 15 
 
 /* Whether to do reverse DNS lookups. */
-#define DO_HOST_LOOKUP 0
+// BRCM #define DO_HOST_LOOKUP 0
 
 /* Whether to print the message of the day (MOTD). */
-#define DO_MOTD 1
+// BRCM #define DO_MOTD 1
 #define MOTD_FILENAME "/etc/motd"
 
 /* Authentication Types - at least one required.
@@ -298,7 +298,10 @@
  * scripts etc. This can be overridden with the -P flag.
  * Homedir is prepended if path begins with ~/
  */
-#define DROPBEAR_PIDFILE "/var/run/dropbear.pid"
+// BRCM  begin
+//#define DROPBEAR_PIDFILE "/var/run/dropbear.pid"
+#define DROPBEAR_PIDFILE "/proc/var/run/dropbear.pid"
+// BRCM end
 
 /* The command to invoke for xauth when using X11 forwarding.
  * "-q" for quiet */
diff -Naur orig_dropbear-2022.83/loginrec.h dropbear-2022.83/loginrec.h
--- orig_dropbear-2022.83/loginrec.h	2022-11-14 22:30:00.000000000 +0800
+++ dropbear-2022.83/loginrec.h	2022-11-16 16:27:25.649860939 +0800
@@ -68,7 +68,7 @@
 
 /* The login() library function in libutil is first choice */
 #if defined(HAVE_LOGIN) && !defined(DISABLE_LOGIN)
-#  define USE_LOGIN
+//#  define USE_LOGIN
 
 #else
 /* Simply select your favourite login types. */
diff -Naur orig_dropbear-2022.83/tcp-accept.c dropbear-2022.83/tcp-accept.c
--- orig_dropbear-2022.83/tcp-accept.c	2022-11-14 22:30:00.000000000 +0800
+++ dropbear-2022.83/tcp-accept.c	2022-11-16 16:27:25.649860939 +0800
@@ -55,7 +55,7 @@
 
 	len = sizeof(sa);
 
-	fd = accept(sock, (struct sockaddr*)&sa, &len);
+	fd = accept(sock, (struct sockaddr*)&sa, (socklen_t *)&len);
 	if (fd < 0) {
 		return;
 	}
diff -Naur orig_dropbear-2022.83/sysoptions.h dropbear-2022.83/sysoptions.h
--- orig_dropbear-2022.83/sysoptions.h	2023-04-10 11:52:13.311328167 +0800
+++ dropbear-2022.83/sysoptions.h	2023-04-10 11:52:46.177974954 +0800
@@ -383,9 +383,11 @@
 #endif
 
 /* Fuzzing expects all key types to be enabled */
+#if DROPBEAR_FUZZ
 #if defined(DROPBEAR_DSS)
 #undef DROPBEAR_DSS
 #endif
 #define DROPBEAR_DSS 1
+#endif
 
 /* no include guard for this file */
