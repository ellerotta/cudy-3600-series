--- orig_libcap/Make.Rules	2023-02-03 11:46:03.000000000 +0800
+++ libcap/Make.Rules	2023-03-02 13:16:28.176861279 +0800
@@ -44,12 +44,12 @@
 
 # Target directories
 
-MANDIR=$(man_prefix)/man
-SBINDIR=$(exec_prefix)/$(sbin)
-INCDIR=$(inc_prefix)/include
-LIBDIR=$(lib_prefix)/$(lib)
-PKGCONFIGDIR=$(LIBDIR)/pkgconfig
-GOPKGDIR=$(prefix)/share/gocode/src
+MANDIR=$(FAKEROOT)$(man_prefix)/man
+SBINDIR=$(FAKEROOT)$(exec_prefix)/$(sbin)
+INCDIR=$(FAKEROOT)$(inc_prefix)/include
+LIBDIR=$(FAKEROOT)$(lib_prefix)/$(lib)
+PKGCONFIGDIR=$(FAKEROOT)$(prefix)/$(lib)/pkgconfig
+GOPKGDIR=$(FAKEROOT)$(prefix)/share/gocode/src
 
 # From here on out, the Go module packages should always remain
 # backwardly compatible. I will only resort to using major version 2
@@ -121,7 +121,7 @@
 # Force enabled with "make DYNAMIC=yes ...".
 DYNAMIC := $(shell if [ ! -d "$(topdir)/.git" ]; then echo $(SHARED); else echo no ; fi)
 
-PAM_CAP ?= $(shell if [ -f /usr/include/security/pam_modules.h ]; then echo $(SHARED) ; else echo no ; fi)
+PAM_CAP :=  no
 
 # If your system does not support pthreads, override this as "no".
 #
@@ -136,7 +136,8 @@
 
 ifeq ($(PTHREADS),yes)
 GO ?= go
-GOLANG ?= $(shell if [ -n "$(shell $(GO) version 2>/dev/null)" ]; then echo yes ; else echo no ; fi)
+#GOLANG := $(shell if [ -n "$(shell $(GO) version 2>/dev/null)" ]; then echo yes ; else echo no ; fi)
+GOLANG := no
 ifeq ($(GOLANG),yes)
 GOROOT ?= $(shell $(GO) env GOROOT)
 GOCGO ?= $(shell if [ "$(shell $(GO) env CGO_ENABLED)" = 1 ]; then echo yes ; else echo no ; fi)
@@ -149,7 +150,7 @@
 CGO_LDFLAGS_ALLOW := CGO_LDFLAGS_ALLOW="-Wl,-?-wrap[=,][^-.@][^,]*"
 endif
 CGO_CFLAGS := $(LIBCAP_INCLUDES)
-CGO_LDFLAGS := -L$(topdir)/libcap
+CGO_LDFLAGS := -L$(topdir)/libcap -L$(BCM_FSINSTALL_DIR)/lib
 GO_BUILD_FLAGS :=
 endif
 endif

--- orig_libcap/libcap/cap_names.h	1970-01-01 08:00:00.000000000 +0800
+++ libcap/libcap/cap_names.h	2023-03-02 13:34:21.812842894 +0800
@@ -0,0 +1,56 @@
+/*
+ * DO NOT EDIT: this file is generated automatically from
+ *
+ *     <uapi/linux/capability.h>
+ */
+
+#define __CAP_BITS       41
+#define __CAP_NAME_SIZE  23
+
+#ifdef LIBCAP_PLEASE_INCLUDE_ARRAY
+#define LIBCAP_CAP_NAMES { \
+      /* 0 */	"cap_chown", \
+      /* 1 */	"cap_dac_override", \
+      /* 2 */	"cap_dac_read_search", \
+      /* 3 */	"cap_fowner", \
+      /* 4 */	"cap_fsetid", \
+      /* 5 */	"cap_kill", \
+      /* 6 */	"cap_setgid", \
+      /* 7 */	"cap_setuid", \
+      /* 8 */	"cap_setpcap", \
+      /* 9 */	"cap_linux_immutable", \
+      /* 10 */	"cap_net_bind_service", \
+      /* 11 */	"cap_net_broadcast", \
+      /* 12 */	"cap_net_admin", \
+      /* 13 */	"cap_net_raw", \
+      /* 14 */	"cap_ipc_lock", \
+      /* 15 */	"cap_ipc_owner", \
+      /* 16 */	"cap_sys_module", \
+      /* 17 */	"cap_sys_rawio", \
+      /* 18 */	"cap_sys_chroot", \
+      /* 19 */	"cap_sys_ptrace", \
+      /* 20 */	"cap_sys_pacct", \
+      /* 21 */	"cap_sys_admin", \
+      /* 22 */	"cap_sys_boot", \
+      /* 23 */	"cap_sys_nice", \
+      /* 24 */	"cap_sys_resource", \
+      /* 25 */	"cap_sys_time", \
+      /* 26 */	"cap_sys_tty_config", \
+      /* 27 */	"cap_mknod", \
+      /* 28 */	"cap_lease", \
+      /* 29 */	"cap_audit_write", \
+      /* 30 */	"cap_audit_control", \
+      /* 31 */	"cap_setfcap", \
+      /* 32 */	"cap_mac_override", \
+      /* 33 */	"cap_mac_admin", \
+      /* 34 */	"cap_syslog", \
+      /* 35 */	"cap_wake_alarm", \
+      /* 36 */	"cap_block_suspend", \
+      /* 37 */	"cap_audit_read", \
+      /* 38 */	"cap_perfmon", \
+      /* 39 */	"cap_bpf", \
+      /* 40 */	"cap_checkpoint_restore", \
+  }
+#endif /* LIBCAP_PLEASE_INCLUDE_ARRAY */
+
+/* END OF FILE */

--- ori_libcap/libcap/Makefile	2022-08-29 05:14:48.000000000 +0800
+++ libcap/libcap/Makefile	2023-03-27 13:29:31.134265445 +0800
@@ -19,7 +19,7 @@
 PSXMAGICOBJ=psx_magic.o
 
 # Always build libcap sources this way:
-CFLAGS += -fPIC
+override CFLAGS += -fPIC
 
 # The linker magic needed to build a dynamic library as independently
 # executable
@@ -75,11 +75,11 @@
 		-e 's,@deps@,$(DEPS),' \
 		$< >$@
 
-_makenames: _makenames.c cap_names.list.h
-	$(BUILD_CC) $(BUILD_CFLAGS) $(BUILD_CPPFLAGS) $< -o $@
+#_makenames: _makenames.c cap_names.list.h
+	#$(BUILD_CC) $(BUILD_CFLAGS) $(BUILD_CPPFLAGS) $< -o $@
 
-cap_names.h: _makenames
-	./_makenames > cap_names.h
+#cap_names.h: _makenames
+	#./_makenames > cap_names.h
 
 $(GPERF_OUTPUT): cap_names.list.h cap_names.header Makefile
 	(cat cap_names.header ; $(BUILD_SED) -e 's/[\{\}"]//g' -e 's/,$$//' cap_names.list.h) | gperf --ignore-case --language=ANSI-C --readonly --null-strings --global-table --hash-function-name=__cap_hash_name --lookup-function-name="__cap_lookup_name" -c -t -m20 $(INDENT) > $@


--- orig_libcap/libcap/cap_names.list.h	1970-01-01 08:00:00.000000000 +0800
+++ libcap/libcap/cap_names.list.h	2023-03-02 13:33:21.812842894 +0800
@@ -0,0 +1,41 @@
+{"cap_chown",0},
+{"cap_dac_override",1},
+{"cap_dac_read_search",2},
+{"cap_fowner",3},
+{"cap_fsetid",4},
+{"cap_kill",5},
+{"cap_setgid",6},
+{"cap_setuid",7},
+{"cap_setpcap",8},
+{"cap_linux_immutable",9},
+{"cap_net_bind_service",10},
+{"cap_net_broadcast",11},
+{"cap_net_admin",12},
+{"cap_net_raw",13},
+{"cap_ipc_lock",14},
+{"cap_ipc_owner",15},
+{"cap_sys_module",16},
+{"cap_sys_rawio",17},
+{"cap_sys_chroot",18},
+{"cap_sys_ptrace",19},
+{"cap_sys_pacct",20},
+{"cap_sys_admin",21},
+{"cap_sys_boot",22},
+{"cap_sys_nice",23},
+{"cap_sys_resource",24},
+{"cap_sys_time",25},
+{"cap_sys_tty_config",26},
+{"cap_mknod",27},
+{"cap_lease",28},
+{"cap_audit_write",29},
+{"cap_audit_control",30},
+{"cap_setfcap",31},
+{"cap_mac_override",32},
+{"cap_mac_admin",33},
+{"cap_syslog",34},
+{"cap_wake_alarm",35},
+{"cap_block_suspend",36},
+{"cap_audit_read",37},
+{"cap_perfmon",38},
+{"cap_bpf",39},
+{"cap_checkpoint_restore",40},
