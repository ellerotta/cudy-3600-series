#!/usr/bin/env perl

#
# DO NOT EDIT THIS FILE
#
# This file reads .config, makes changes, and writes it back
# if you need to make further changes, COPY this file to another
# executable file in the config.d directory with a .conf extension 
# and replace the ACTIONS section with your own
#

use strict;
use warnings;
use BRCM::GenConfig;

my $g;
if (!@ARGV){
  print "\n Use the default configuration file. e.g. .config \n";
  $g = new BRCM::GenConfig('.config');
}else{
  $g = new BRCM::GenConfig($ARGV[0]);
}

# ACTIONS start here

my $extra_brcm_path="";
if ($ENV{BRCM_EXTRA_PATH} )
{
    $extra_brcm_path="$ENV{BRCM_EXTRA_PATH}"
}

$g->set( "CONFIG_PREFIX", qq["$ENV{INSTALL_DIR}/$extra_brcm_path"] );

if ( $ENV{BUILD_BCMBUSYBOX_NTPD} eq 'y' ) {
    $g->set( "CONFIG_NTPD",                      "y" );
}else{
    $g->unset( "CONFIG_NTPD" );
}

if ( $ENV{BUILD_GPON} ne '' ) {
    $g->set( "CONFIG_TRACEROUTE",                  "y" );
    $g->set( "CONFIG_TRACEROUTE6",                 "y" );
    $g->set( "CONFIG_FEATURE_TRACEROUTE_USE_ICMP", "y" );
}

if ( $ENV{BUILD_ASAN} ne '' ) {
    $g->set( "CONFIG_DEBUG_SANITIZE",              "y" );
}
# ACTIONS end here

$g->write();


