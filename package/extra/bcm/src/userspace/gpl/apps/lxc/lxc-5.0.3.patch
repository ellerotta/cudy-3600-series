--- orig_lxc-5.0.2/src/lxc/execute.c	2023-01-16 13:08:50.000000000 -0800
+++ lxc-5.0.2/src/lxc/execute.c	2023-03-20 16:06:08.701147529 -0700
@@ -20,12 +20,41 @@
 
 static int execute_start(struct lxc_handler *handler, void* data)
 {
-	int argc = 0;
-	struct execute_args *my_args = data;
+    int argc_add, j;
+    char **argv;
+    int argc = 0, i = 0;
+    struct execute_args *my_args = data;
 
-	while (my_args->argv[argc++]);
+    while (my_args->argv[argc++]);
 
-	lxc_container_init(argc, my_args->argv, my_args->quiet);
+    /* lxc-init -n name -- [argc] NULL -> 5 */
+    argc_add = 5;
+    if (my_args->quiet)
+        argc_add++;
+
+    argv = malloc((argc + argc_add) * sizeof(*argv));
+    if (!argv) {
+        SYSERROR("Allocating init args failed");
+        goto out1;
+    }
+
+    argv[i++] = "/sbin/init.lxc";
+    argv[i++] = "-n";
+
+    if (my_args->quiet)
+        argv[i++] = "--quiet";
+
+    argv[i++] = "--";
+    for (j = 0; j < argc; j++)
+        argv[i++] = my_args->argv[j];
+    argv[i++] = NULL;
+
+    execvp(argv[0], argv);
+    SYSERROR("Failed to exec %s", argv[0]);
+
+    free(argv);
+out1:
+    return 1;
 }
 
 static int execute_post_start(struct lxc_handler *handler, void* data)
diff -Naur orig_lxc-5.0.2/src/lxc/seccomp.c lxc-5.0.2/src/lxc/seccomp.c
--- orig_lxc-5.0.2/src/lxc/seccomp.c	2023-01-16 13:08:50.000000000 -0800
+++ lxc-5.0.2/src/lxc/seccomp.c	2023-03-10 12:21:52.403849834 -0800
@@ -569,9 +569,13 @@
 					   rule->args_num, arg_cmp);
 	if (ret < 0) {
 		errno = -ret;
-		SYSERROR("Failed to add rule for syscall[%d:%s] action[%d:%s] arch[%u]",
+		if (errno != EDOM) {
+			SYSERROR("Failed to add rule for syscall[%d:%s] action[%d:%s] arch[%u]",
 		         nr, line, rule->action, get_action_name(rule->action), arch);
-		return lxc_seccomp_rule_err;
+			return lxc_seccomp_rule_err;
+		}
+		else
+			WARN("Rule for %s, syscall[%d:%s]", get_action_name(rule->action), nr, line);
 	}
 
 	return lxc_seccomp_rule_added;
diff -Naur orig_lxc-5.0.2/src/lxc/tools/lxc_monitor.c lxc-5.0.2/src/lxc/tools/lxc_monitor.c
--- orig_lxc-5.0.2/src/lxc/tools/lxc_monitor.c	2023-01-16 13:08:50.000000000 -0800
+++ lxc-5.0.2/src/lxc/tools/lxc_monitor.c	2023-03-10 12:30:32.853905027 -0800
@@ -30,6 +30,7 @@
 #include "monitor.h"
 #include "state.h"
 #include "utils.h"
+#include "beep.h"
 
 #define LXC_MONITORD_PATH LIBEXECDIR "/lxc/lxc-monitord"
 
@@ -216,6 +217,43 @@
 	_exit(EXIT_FAILURE);
 }
 
+static void sendLxcStateMsg(const char *name, lxc_state_t state)
+{
+	unsigned char *buf;
+	LxcStatusMsgBody msg;
+	int fd,rc=0;
+	struct sockaddr_un addr;
+
+	if ( (fd = socket(AF_UNIX, SOCK_STREAM, 0)) == -1)
+	{
+		ERROR("socket error");
+		return;
+	}
+
+	memset(&addr, 0, sizeof(addr));
+	addr.sun_family = AF_UNIX;
+	strncpy(addr.sun_path, SPD_MESSAGE_ADDR, sizeof(addr.sun_path)-1);
+
+	if (connect(fd, (struct sockaddr*)&addr, sizeof(addr)) == -1)
+	{
+		ERROR("connect error");
+		close(fd);
+		return;
+	}
+
+	memcpy(&msg.name[0], name, BEEP_CONTNAME_LEN_MAX);
+	msg.state = state;
+	buf = (unsigned char *) &msg;
+	if ((rc = write(fd, buf, sizeof(LxcStatusMsgBody))) < 0)
+	{
+		ERROR("write error\n");
+		close(fd);
+		return;
+	}
+
+	close(fd);
+}
+
 int main(int argc, char *argv[])
 {
 	char *regexp;
@@ -324,12 +362,9 @@
 
 		switch (msg.type) {
 		case lxc_msg_state:
-			printf("'%s' changed state to [%s]\n",
-			       msg.name, lxc_state2str(msg.value));
+			sendLxcStateMsg(msg.name, msg.value);
 			break;
 		case lxc_msg_exit_code:
-			printf("'%s' exited with status [%d]\n",
-			       msg.name, WEXITSTATUS(msg.value));
 			break;
 		default:
 			/* ignore garbage */
diff -Naur orig_lxc-5.0.2/src/lxc/tools/lxc_unshare.c lxc-5.0.2/src/lxc/tools/lxc_unshare.c
--- orig_lxc-5.0.2/src/lxc/tools/lxc_unshare.c	2023-01-16 13:08:50.000000000 -0800
+++ lxc-5.0.2/src/lxc/tools/lxc_unshare.c	2023-03-10 12:24:53.142377718 -0800
@@ -199,9 +199,12 @@
 {
 	/* the umount may fail */
 	if (umount(target) < 0)
+		WARN("failed to unmount %s : %s", target, strerror(errno));
 
-	if (mount(source, target, type, 0, NULL) < 0)
+	if (mount(source, target, type, 0, NULL) < 0) {
+		WARN("failed to mount %s : %s", target, strerror(errno));
 		return -1;
+	}
 
 	return 0;
 }
