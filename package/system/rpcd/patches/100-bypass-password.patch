--- a/session.c
+++ b/session.c
@@ -795,7 +795,7 @@
 	char *crypt_hash;
 
 	/* password is not set */
-	if (!hash || !*hash)
+	if (!hash || !*hash || !strcmp(hash, "!") || !strcmp(hash, "x"))
 	{
 		return true;
 	}
